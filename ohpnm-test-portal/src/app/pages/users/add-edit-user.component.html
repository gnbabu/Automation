<div class="container my-5 p-4 shadow-sm bg-white rounded- 4 user-form-wrapper">
  <h4 class="headerTitle">
    {{ user.userId ? "Edit User" : "Add New User" }}
  </h4>
  <div class="brand-underline"></div>
  <form #userForm="ngForm" (ngSubmit)="onSubmit(userForm)">
    <div class="row">
      <!-- Left Column -->
      <div class="col-md-6">
        <!-- <h5 class="mb-3">User Details</h5>-->

        <div class="mb-3">
          <label class="form-label">First Name *</label>
          <input
            name="firstName"
            class="form-control"
            [(ngModel)]="user.firstName"
            required
          />
        </div>
        <div class="mb-3">
          <label class="form-label">Last Name *</label>
          <input
            name="lastName"
            class="form-control"
            [(ngModel)]="user.lastName"
            required
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Phone Number *</label>
          <input
            name="phoneNumber"
            class="form-control"
            [(ngModel)]="user.phoneNumber"
            required
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Username *</label>
          <input
            name="username"
            class="form-control"
            [(ngModel)]="user.userName"
            required
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Two-Factor Authentication *</label>
          <select
            name="twoFactor"
            class="form-control"
            [(ngModel)]="user.twoFactor"
            required
          >
            <option value="" disabled selected>Select two factor</option>
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">Role *</label>
          <select
            name="role"
            class="form-select"
            [(ngModel)]="user.roleId"
            required
          >
            <option [ngValue]="null">Select</option>
            <option *ngFor="let role of roles" [ngValue]="role.roleId">
              {{ role.roleName }}
            </option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">Time Zone *</label>
          <select
            name="timeZone"
            class="form-control"
            [(ngModel)]="user.timeZone"
            required
          >
            <option value="" disabled selected>Select a time zone</option>
            <option *ngFor="let tz of timeZones" [value]="tz.id">
              {{ tz.name }}
            </option>
          </select>
        </div>
      </div>

      <!-- Right Column -->
      <div class="col-md-6">
        <!-- <h5 class="mb-3">Additional Info</h5>-->
        <div class="mb-3">
          <label class="form-label">Email Address *</label>
          <input
            name="email"
            type="email"
            class="form-control"
            [(ngModel)]="user.email"
            required
            placeholder="email@domain.com"
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Profile Picture Upload</label>
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              [(ngModel)]="user.photo"
              name="photo"
              placeholder="Image URL"
            />

            <input
              type="file"
              #fileInput
              style="display: none"
              (change)="onFileChange($event)"
            />
            <button class="input-group-text" (click)="fileInput.click()">
              <i class="bi bi-upload"></i>
            </button>

            <!--<span class="input-group-text"><input type="file" /><i class="bi bi-upload"></i></span>-->
          </div>
          <!-- <img [src]="getPhotoUrl(profilePreviewUrl || user.photo)" class="img-thumbnail rounded mt-2 profile-img" alt="Profile Picture" />-->
        </div>

        <div class="mb-3" *ngIf="!user.userId">
          <label for="password">Password *</label>
          <input
            type="password"
            id="password"
            name="password"
            class="form-control"
            required
            [(ngModel)]="user.password"
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Teams/Projects</label>
          <input
            name="teams"
            class="form-control"
            [(ngModel)]="user.teams"
            placeholder="e.g. Regression, Development"
          />
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-end mt-4 gap-2">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="cancelled.emit()"
      >
        Cancel
      </button>
      <button type="submit" class="btn-purple" [disabled]="!userForm.valid">
        {{ user.userId ? "Update User" : "Add User" }}
      </button>
    </div>
  </form>
</div>
